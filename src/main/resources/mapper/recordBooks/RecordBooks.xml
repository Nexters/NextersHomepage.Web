<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"     
          "http://mybatis.org/dtd/mybatis-3-mapper.dtd">    
<mapper namespace="com.teamnexters.mapper">   
	<select id="getBooksList" resultType="HashMap">
		SELECT
			"bookNo"
			, MAX("bookNm") as "bookNm"
			, COUNT("bookNm") as "total"
		FROM (
			SELECT 
				bs."bookNo"
				, bs."bookNm"
			FROM
				books bs
			LEFT JOIN books_user bu ON bu."bookNo" = bs."bookNo" 
		) as vTable1
		GROUP BY "bookNo"
		ORDER BY "bookNo" desc
	</select>
	

</mapper>
